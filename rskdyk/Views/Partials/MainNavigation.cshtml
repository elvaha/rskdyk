@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@using Umbraco.Web.Models
@using Umbraco.Web
@using Umbraco.Web.Models
@using Umbraco.Web.Controllers

@*
    This snippet displays a list of links of the pages immediately under the top-most page in the content tree.
    This is the home page for a standard website.
    It also highlights the current active page/section in the navigation with the css class "current".
*@

@{ var selection = CurrentPage.Site().Children.Where("Visible");
    var loginStatus = Members.GetCurrentLoginStatus();
}

<ul>
    @foreach (var item in selection)
    {
        if (item.Children.Where("Visible").Count() > 0)
        {
            <li>
                <a href="@item.Url">@item.Name</a>
            </li>
            <li>
                <ul>
                    @foreach(var child in item.Children.Where("Visible")){
                    @*Styling for dropdown children of page*@
                    <li>@child.Name</li>
                    }
                </ul>
            </li>
        }
        else
        {
            <li class="@(item.IsAncestorOrSelf(CurrentPage) ? "current" : null)">
                <a href="@item.Url">@item.Name</a>
            </li>
            }
            }
            <li>
                    @if(loginStatus.IsLoggedIn){
                        //Show some logout and link to profile page
                        <a href="/profile-page/">Profile</a>
                        <a href='@Url.Action("Logout", "LoginSurface")'>Logout</a>
                    }else{
                        <a href="/login-page/">Login</a>
                    }
                </li>
        </ul>